<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Super Educated Class - Admission Test Result</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f6fc;
      margin: 0;
      padding: 0;
    }
    header {
      background: #004080;
      color: #fff;
      text-align: center;
      padding: 20px;
    }
    .container {
      max-width: 500px;
      background: #fff;
      margin: 40px auto;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    label, select, input {
      display: block;
      margin: 10px 0;
      width: 100%;
      font-size: 16px;
      padding: 8px;
    }
    button {
      width: 100%;
      padding: 10px;
      background: #004080;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      margin-top: 8px;
    }
    button:hover {
      background: #0066cc;
    }
    /* Popup */
    .popup {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
    }
    .popup-content {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      max-width: 500px;
      width: 90%;
      text-align: center;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      animation: fadeIn 0.3s ease-in-out;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: scale(0.9);}
      to {opacity: 1; transform: scale(1);}
    }
    .close-btn {
      background: crimson;
    }
    .pdf-btn {
      background: green;
    }
    .next-btn {
      background: orange;
    }
    .logo {
      width: 80px;
      margin-bottom: 10px;
    }
    .signature {
      margin-top: 20px;
      text-align: right;
      font-style: italic;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header>
    <h1>Super Educated Class</h1>
    <p>Shekhpur Daud, Fariha, Azamgarh</p>
  </header>

  <div class="container">
    <label for="roll">Enter Roll Number:</label>
    <input type="text" id="roll" placeholder="e.g. 101" onkeyup="if(event.key==='Enter'){showResult()}">

    <label for="year">Select Year:</label>
    <select id="year">
      <option value="2025">2025</option>
    </select>

    <button onclick="showResult()">Show Result</button>
  </div>

  <!-- Popup -->
  <div class="popup" id="popup">
    <div class="popup-content" id="popupContent">
      <!-- Result will load here -->
    </div>
  </div>

  <script>
    const fullMarks = { english: 16, maths: 18, science: 16 };
    const totalMarks = fullMarks.english + fullMarks.maths + fullMarks.science;

    const results = {
      "101": {
        name: "Mayank Prajapati", father: "Ramesh P.", mother: "Sunita P.", class: "6th",
        english: 8, maths: 10, science: 7
      },
      "102": {
        name: "Anshika Prajapati", father: "Rajesh P.", mother: "Meena P.", class: "7th",
        english: 12, maths: 15, science: 14
      },
      "103": {
        name: "Aradhya Prajapati", father: "Suresh P.", mother: "Rekha P.", class: "5th",
        english: 11, maths: 14, science: 12
      },
      "104": {
        name: "Indu Prajapati", father: "Mahesh P.", mother: "Shobha P.", class: "8th",
        english: 13, maths: 15, science: 14
      },
      "105": {
        name: "Chanchal Prajapati", father: "Naresh P.", mother: "Anita P.", class: "6th",
        english: 10, maths: 13, science: 12
      },
      "106": {
        name: "Shivam Prajapati", father: "Vinod P.", mother: "Suman P.", class: "7th",
        english: 6, maths: 9, science: 8
      }
    };

    let currentResult = null;

    function showResult() {
      const roll = document.getElementById("roll").value.trim();
      const popup = document.getElementById("popup");
      const popupContent = document.getElementById("popupContent");

      if(results[roll]) {
        let r = results[roll];
        let obtain = r.english + r.maths + r.science;
        let percent = ((obtain / totalMarks) * 100).toFixed(2);
        let status = (obtain >= 30) 
          ? "<span style='color:green;font-weight:bold;'>You are Selected ✅</span>" 
          : "<span style='color:red;font-weight:bold;'>You are Not Selected, Try Again ❌</span>";

        currentResult = {roll, ...r, obtain, percent, status};

        popupContent.innerHTML = `
          <img src="logo.png" alt="Logo" class="logo">
          <h2>Admission Test Result - ${document.getElementById("year").value}</h2>
          <p><b>Name:</b> ${r.name}</p>
          <p><b>Father's Name:</b> ${r.father}</p>
          <p><b>Mother's Name:</b> ${r.mother}</p>
          <p><b>Class:</b> ${r.class}</p>
          <hr>
          <table border="1" cellspacing="0" cellpadding="5" style="width:100%; text-align:center;">
            <tr style="background:#f0f0f0;">
              <th>Subject</th>
              <th>Marks Obtained</th>
              <th>Full Marks</th>
            </tr>
            <tr><td>English</td><td>${r.english}</td><td>${fullMarks.english}</td></tr>
            <tr><td>Maths</td><td>${r.maths}</td><td>${fullMarks.maths}</td></tr>
            <tr><td>Science</td><td>${r.science}</td><td>${fullMarks.science}</td></tr>
          </table>
          <p><b>Total Marks:</b> ${obtain}/${totalMarks}</p>
          <p><b>Percentage:</b> ${percent}%</p>
          <h3>Status: ${status}</h3>
          <div class="signature">Principal / Director</div>
          <button class="pdf-btn" onclick="downloadPDF()">Download PDF</button>
          <button class="next-btn" onclick="nextResult()">Next Result</button>
          <button class="close-btn" onclick="closePopup()">Close</button>
        `;
        popup.style.display = "flex";
      } else {
        alert("❌ Invalid Roll Number");
      }
    }

    function closePopup() {
      document.getElementById("popup").style.display = "none";
    }

    function nextResult() {
      document.getElementById("roll").value = "";
      document.getElementById("roll").focus();
    }

    async function downloadPDF() {
      if (!currentResult) return;
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      try {
        const img = new Image();
        img.src = "logo.png"; 
        doc.addImage(img, "PNG", 160, 10, 30, 20);
      } catch (e) {}

      // Coaching Name & Address Centered
      doc.setFontSize(18);
      doc.setFont("helvetica", "bold");
      doc.text("Super Educated Class", 105, 20, { align: "center" });

      doc.setFontSize(14);
      doc.setFont("helvetica", "bold");
      doc.text("Shekhpur Daud, Fariha, Azamgarh", 105, 28, { align: "center" });

      doc.setFontSize(12);
      doc.setFont("helvetica", "normal");
      doc.text(`Admission Test Result - ${document.getElementById("year").value}`, 105, 38, { align: "center" });
      doc.line(20, 42, 190, 42);

      doc.setFontSize(12);
      doc.text(`Roll No: ${currentResult.roll}`, 20, 50);
      doc.text(`Name: ${currentResult.name}`, 20, 58);
      doc.text(`Father's Name: ${currentResult.father}`, 20, 66);
      doc.text(`Mother's Name: ${currentResult.mother}`, 20, 74);
      doc.text(`Class: ${currentResult.class}`, 20, 82);

      doc.autoTable({
        startY: 95,
        head: [['Subject', 'Marks Obtained', 'Full Marks']],
        body: [
          ['English', currentResult.english, fullMarks.english],
          ['Maths', currentResult.maths, fullMarks.maths],
          ['Science', currentResult.science, fullMarks.science],
        ],
        theme: 'grid'
      });

      let finalY = doc.lastAutoTable.finalY + 10;
      doc.setFont("helvetica", "bold");
      doc.text(`Total Marks: ${currentResult.obtain}/${totalMarks}`, 20, finalY);
      doc.text(`Percentage: ${currentResult.percent}%`, 20, finalY + 8);
      doc.text(`Status: ${currentResult.status.replace(/<[^>]*>/g, '')}`, 20, finalY + 16);

      doc.line(140, finalY + 40, 190, finalY + 40);
      doc.text("Principal / Director", 145, finalY + 48);

      doc.save(`Result_${currentResult.roll}.pdf`);
    }
  </script>
</body>
</html>
